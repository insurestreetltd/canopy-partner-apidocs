
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-12ec0f84.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-953e3353.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e033bdd3.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;,&quot;php&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-8f56d7a9.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#requesting-your-credentials" class="toc-h1 toc-link" data-title="Requesting Your Credentials">Requesting Your Credentials</a>
          </li>
          <li>
            <a href="#using-api-key" class="toc-h1 toc-link" data-title="Using API key">Using API key</a>
          </li>
          <li>
            <a href="#requesting-an-api-token" class="toc-h1 toc-link" data-title="Requesting an API Token">Requesting an API Token</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#http-request" class="toc-h2 toc-link" data-title="HTTP Request">HTTP Request</a>
                  </li>
                  <li>
                    <a href="#body-parameters" class="toc-h2 toc-link" data-title="Body Parameters">Body Parameters</a>
                  </li>
                  <li>
                    <a href="#using-api-token" class="toc-h2 toc-link" data-title="Using API token">Using API token</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#refresh-secret-key" class="toc-h1 toc-link" data-title="Refresh Secret Key">Refresh Secret Key</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#http-request-2" class="toc-h2 toc-link" data-title="HTTP Request">HTTP Request</a>
                  </li>
                  <li>
                    <a href="#body-parameters-2" class="toc-h2 toc-link" data-title="Body Parameters">Body Parameters</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#check-permission" class="toc-h1 toc-link" data-title="Check permission">Check permission</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#http-request-3" class="toc-h2 toc-link" data-title="HTTP Request">HTTP Request</a>
                  </li>
                  <li>
                    <a href="#url-parameters" class="toc-h2 toc-link" data-title="URL Parameters">URL Parameters</a>
                  </li>
                  <li>
                    <a href="#query-parameters" class="toc-h2 toc-link" data-title="Query Parameters">Query Parameters</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#request-permission" class="toc-h1 toc-link" data-title="Request permission">Request permission</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#http-request-4" class="toc-h2 toc-link" data-title="HTTP Request">HTTP Request</a>
                  </li>
                  <li>
                    <a href="#url-parameters-2" class="toc-h2 toc-link" data-title="URL Parameters">URL Parameters</a>
                  </li>
                  <li>
                    <a href="#body-parameters-3" class="toc-h2 toc-link" data-title="Body Parameters">Body Parameters</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#create-connection" class="toc-h1 toc-link" data-title="Create connection">Create connection</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#http-request-5" class="toc-h2 toc-link" data-title="HTTP Request">HTTP Request</a>
                  </li>
                  <li>
                    <a href="#url-parameters-3" class="toc-h2 toc-link" data-title="URL Parameters">URL Parameters</a>
                  </li>
                  <li>
                    <a href="#body-parameters-4" class="toc-h2 toc-link" data-title="Body Parameters">Body Parameters</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#webhooks-endpoints" class="toc-h1 toc-link" data-title="Webhooks Endpoints">Webhooks Endpoints</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#register-webhook" class="toc-h2 toc-link" data-title="Register Webhook">Register Webhook</a>
                  </li>
                  <li>
                    <a href="#unregister-webhook" class="toc-h2 toc-link" data-title="Unregister Webhook">Unregister Webhook</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Canopy API for Partners!</p>

<p>We follow standard behavior in terms of URL&#39;s, JSON request/response bodies where 
applicable and standard HTTP error codes. </p>
<h1 id='requesting-your-credentials'>Requesting Your Credentials</h1>
<p>To work with Partners API you need to get authentication credentials. These credentials 
provided by the Canopy side by manual request. Please speak to your account manager 
here to obtain the details for the environments.</p>

<p>Credentials include 3 values:</p>

<ul>
<li>Partner ID – ID of your account</li>
<li>API Key – client specific Key for accessing to Canopy API functions</li>
<li>Secret Key – will be used for authentication</li>
</ul>
<h1 id='using-api-key'>Using API key</h1>
<p>Canopy expects the <code>API Key</code> will be included in the header for all API requests. </p>

<p>See example below:</p>

<p><code>x-api-key: ePYgsiGbWF5aAHBj0xT9Pa1k5li0NPMD25PQXbAC</code></p>
<h1 id='requesting-an-api-token'>Requesting an API Token</h1>
<blockquote>
<p>To get API token, use this code:</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">jwt</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">jsonwebtoken</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">canopyEndpointBaseUri</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">canopy_base_uri</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">partnerId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">your_partner_id</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">partnerSecretKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">your_secret_key</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">canopyApiKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">your_api_key</span><span class="dl">"</span><span class="p">;</span>

<span class="c1">// Function that generates jwt token payload using partnerId</span>
<span class="kd">const</span> <span class="nx">generatePayload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">now</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">);</span> <span class="c1">// sec</span>
  <span class="kd">const</span> <span class="nx">expires</span> <span class="o">=</span> <span class="nx">now</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">payload</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">iss</span><span class="p">:</span> <span class="dl">"</span><span class="s2">canopy.rent</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">scope</span><span class="p">:</span> <span class="dl">"</span><span class="s2">request.write_only document.read_only</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">aud</span><span class="p">:</span> <span class="s2">`referencing-requests/partner/</span><span class="p">${</span><span class="nx">partnerId</span><span class="p">}</span><span class="s2">/token`</span><span class="p">,</span>
    <span class="na">exp</span><span class="p">:</span> <span class="nx">expires</span><span class="p">,</span>
    <span class="na">iat</span><span class="p">:</span> <span class="nx">now</span><span class="p">,</span>
  <span class="p">};</span>

  <span class="k">return</span> <span class="nx">payload</span><span class="p">;</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">authenticate</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// Generate jwt key</span>
  <span class="kd">const</span> <span class="nx">jwtKey</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">jwt</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">generatePayload</span><span class="p">(),</span> <span class="nx">partnerSecretKey</span><span class="p">);</span>

  <span class="c1">// Send POST request</span>
  <span class="k">return</span> <span class="nx">axios</span><span class="p">({</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">canopyEndpointBaseUri</span><span class="p">}</span><span class="s2">/referencing-requests/partner/</span><span class="p">${</span><span class="nx">partnerId</span><span class="p">}</span><span class="s2">/token`</span><span class="p">,</span>
    <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1">// Add API key from the credentials into headers</span>
      <span class="dl">"</span><span class="s2">x-api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">canopyApiKey</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">jwtKey</span><span class="p">:</span> <span class="nx">jwtKey</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">});</span>
<span class="p">};</span>

<span class="nx">authenticate</span><span class="p">();</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require_once</span> <span class="s1">'vendor/autoload.php'</span><span class="p">;</span>

<span class="c1">// For JWT generation we used Firebase PHP-JWT library: https://github.com/firebase/php-jwt</span>
<span class="kn">use</span> <span class="err">\</span><span class="no">Firebase\JWT\JWT</span><span class="p">;</span>

<span class="nv">$partnerId</span> <span class="o">=</span> <span class="s2">"your_partner_id"</span><span class="p">;</span>
<span class="nv">$secretKey</span> <span class="o">=</span> <span class="s2">"your_secret_key"</span><span class="p">;</span>

<span class="nv">$now</span> <span class="o">=</span> <span class="nb">time</span><span class="p">();</span>

<span class="c1">// Generate JWT payload</span>
<span class="nv">$payload</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s2">"iss"</span> <span class="o">=&gt;</span> <span class="s2">"canopy.rent"</span><span class="p">,</span>
    <span class="s2">"scope"</span> <span class="o">=&gt;</span> <span class="s2">"request.write_only document.read_only"</span><span class="p">,</span>
    <span class="s2">"aud"</span> <span class="o">=&gt;</span> <span class="s2">"referencing-requests/partner/</span><span class="nv">$partnerId</span><span class="s2">/token"</span><span class="p">,</span>
    <span class="s2">"exp"</span> <span class="o">=&gt;</span> <span class="nv">$now</span> <span class="o">+</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">,</span>
    <span class="s2">"iat"</span> <span class="o">=&gt;</span> <span class="nv">$now</span>
<span class="p">);</span>

<span class="c1">// Generate JWT key using payload and secret key</span>
<span class="nv">$jwt</span> <span class="o">=</span> <span class="no">JWT</span><span class="o">::</span><span class="nf">encode</span><span class="p">(</span><span class="nv">$payload</span><span class="p">,</span> <span class="nv">$secretKey</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$jwt</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

<span class="nv">$canopyEndpointBaseUri</span> <span class="o">=</span> <span class="s2">"canopy_base_uri"</span><span class="p">;</span>
<span class="nv">$apiKey</span> <span class="o">=</span> <span class="s2">"your_api_key"</span><span class="p">;</span>

<span class="c1">// We used Guzzle as HTTP client: https://docs.guzzlephp.org/en/stable/#</span>
<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="err">\</span><span class="nf">GuzzleHttp\Client</span><span class="p">();</span>

<span class="c1">// Send POST request to get access token with your api key and generated JWT key</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">request</span><span class="p">(</span>
  <span class="s2">"POST"</span><span class="p">,</span>
  <span class="s2">"</span><span class="nv">$canopyEndpointBaseUri</span><span class="s2">/referencing-requests/partner/</span><span class="nv">$partnerId</span><span class="s2">/token"</span><span class="p">,</span>
  <span class="p">[</span>
    <span class="s2">"headers"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"Content-Type"</span> <span class="o">=&gt;</span> <span class="s2">"application/json"</span><span class="p">,</span>
      <span class="s2">"x-api-key"</span> <span class="o">=&gt;</span> <span class="nv">$apiKey</span>
    <span class="p">],</span>
    <span class="s2">"json"</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"jwtKey"</span> <span class="o">=&gt;</span> <span class="nv">$jwt</span><span class="p">]</span>
  <span class="p">]</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getBody</span><span class="p">(),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bearer eyaasd456FFGDFGdfgdfgdfgdfg7sdyfg35htjl3bhef89y4rjkbergv-KAj-dGh0xEuZftO_Utm6dugKQ"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"expires"</span><span class="p">:</span><span class="w"> </span><span class="mi">1594907203</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>Before you can start working with protected API functions, you need to get the API Token. </p>

<ul>
<li>API Token – it can be treated as user session ID</li>
</ul>

<p>This API Token must be used as authorization header in all API calls to protected functions. 
Example API Token usage in the header</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST /referencing-requests/partner/:partnerId/token</code></p>
<h3 id='body-parameters'>Body Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>jwtKey</td>
<td>string</td>
<td>true</td>
<td>Generated jwt key</td>
</tr>
</tbody></table>
<h3 id='using-api-token'>Using API token</h3>
<p>You need to request an API token to make calls to the Canopy API. Canopy expects for the API token to be included in all requests to the API in a header that looks like the following:</p>

<p><code>Authorization: Bearer eyaasd456FFGDFGdfgdfgdfgdfg7sdyfg35htjl3bhef89y4rjkbergv-KAj-dGh0xEuZftO_Utm6dugKQ</code></p>
<h1 id='refresh-secret-key'>Refresh Secret Key</h1><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">canopyEndpointBaseUri</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">canopy_base_uri</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">axios</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">canopyEndpointBaseUri</span><span class="p">}</span><span class="s2">/referencing-requests/partner/refresh`</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">authorization_token</span><span class="dl">"</span>
    <span class="dl">"</span><span class="s2">x-api-key</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">api_key</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">secretKey</span><span class="p">:</span> <span class="dl">"</span><span class="s2">new_secret_key</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="nv">$canopyEndpointBaseUri</span> <span class="o">=</span> <span class="s2">"canopy_base_uri"</span><span class="p">;</span>
<span class="nv">$apiKey</span> <span class="o">=</span> <span class="s2">"your_api_key"</span><span class="p">;</span>
<span class="nv">$authorizationToken</span> <span class="o">=</span> <span class="s2">"authorization_token"</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="err">\</span><span class="nf">GuzzleHttp\Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">request</span><span class="p">(</span>
  <span class="s2">"POST"</span><span class="p">,</span>
  <span class="s2">"</span><span class="nv">$canopyEndpointBaseUri</span><span class="s2">/referencing-requests/partner/refresh"</span><span class="p">,</span>
  <span class="p">[</span>
    <span class="s2">"headers"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"Authorization"</span> <span class="o">=&gt;</span> <span class="nv">$authorizationToken</span><span class="p">,</span>
      <span class="s2">"x-api-key"</span> <span class="o">=&gt;</span> <span class="nv">$apiKey</span>
    <span class="p">],</span>
    <span class="s2">"json"</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"secretKey"</span> <span class="o">=&gt;</span> <span class="s2">"new_secret_key"</span><span class="p">]</span>
  <span class="p">]</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getBody</span><span class="p">(),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"request_id"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"secretKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"new_secret_key"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint may be called to change current <code>secretKey</code> (which is required for <code>jwtKey</code> generation) and get back freshly generated one. Accepts currently active <code>secretKey</code> in request body. After receiving successful response with new <code>secretKey</code>, previous <code>secretKey</code> becomes stale and should not be used for <code>jwtKey</code> generation.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>POST /referencing-requests/partner/refresh</code></p>
<h3 id='body-parameters-2'>Body Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>secretKey</td>
<td>string</td>
<td>true</td>
<td>Currently active secret key</td>
</tr>
</tbody></table>
<h1 id='check-permission'>Check permission</h1><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">canopyEndpointBaseUri</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">canopy_base_uri</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">your_api_key</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">authorizationToken</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">authorization_token</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">partnerId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">partner_id</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">axios</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">canopyEndpointBaseUri</span><span class="p">}</span><span class="s2">/referencing-requests/partner/</span><span class="p">${</span><span class="nx">partnerId</span><span class="p">}</span><span class="s2">/permission?email=example@gmail.com`</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">GET</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="nx">authorizationToken</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">x-api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apiKey</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="nv">$canopyEndpointBaseUri</span> <span class="o">=</span> <span class="s2">"canopy_base_uri"</span><span class="p">;</span>
<span class="nv">$apiKey</span> <span class="o">=</span> <span class="s2">"your_api_key"</span><span class="p">;</span>
<span class="nv">$authorizationToken</span> <span class="o">=</span> <span class="s2">"authorization_token"</span><span class="p">;</span>
<span class="nv">$partnerId</span> <span class="o">=</span> <span class="s2">"your_partner_id"</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="err">\</span><span class="nf">GuzzleHttp\Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">request</span><span class="p">(</span>
  <span class="s2">"GET"</span><span class="p">,</span>
  <span class="s2">"</span><span class="nv">$canopyEndpointBaseUri</span><span class="s2">/referencing-requests/partner/</span><span class="nv">$partnerId</span><span class="s2">/permission?email=example@gmail.com"</span><span class="p">,</span>
  <span class="p">[</span>
    <span class="s2">"headers"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"Authorization"</span> <span class="o">=&gt;</span> <span class="nv">$authorizationToken</span><span class="p">,</span>
      <span class="s2">"x-api-key"</span> <span class="o">=&gt;</span> <span class="nv">$apiKey</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getBody</span><span class="p">(),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"request_id"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"renterId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UUID"</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint used to check current state of the user share permission to your company.</p>

<p>If user granted <code>share permission</code> to your company you will receive <code>renterId</code>, in other case 
will be <code>404 error</code>.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET /referencing-requests/partner/:partnerId/permission?email=example@gmail.com</code></p>
<h3 id='url-parameters'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>partnerId</td>
<td>Your partner reference</td>
</tr>
</tbody></table>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>true</td>
<td>Renter email</td>
</tr>
</tbody></table>
<h1 id='request-permission'>Request permission</h1><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">canopyEndpointBaseUri</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">canopy_base_uri</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">your_api_key</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">authorizationToken</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">authorization_token</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">partnerId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">partner_id</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">axios</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">canopyEndpointBaseUri</span><span class="p">}</span><span class="s2">/referencing-requests/partner/</span><span class="p">${</span><span class="nx">partnerId</span><span class="p">}</span><span class="s2">/permission`</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="nx">authorizationToken</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">x-api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apiKey</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="nl">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">email</span><span class="p">:</span> <span class="dl">"</span><span class="s2">example@gmail.com</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="nv">$canopyEndpointBaseUri</span> <span class="o">=</span> <span class="s2">"canopy_base_uri"</span><span class="p">;</span>
<span class="nv">$apiKey</span> <span class="o">=</span> <span class="s2">"your_api_key"</span><span class="p">;</span>
<span class="nv">$authorizationToken</span> <span class="o">=</span> <span class="s2">"authorization_token"</span><span class="p">;</span>
<span class="nv">$partnerId</span> <span class="o">=</span> <span class="s2">"your_partner_id"</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="err">\</span><span class="nf">GuzzleHttp\Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">request</span><span class="p">(</span>
  <span class="s2">"POST"</span><span class="p">,</span>
  <span class="s2">"</span><span class="nv">$canopyEndpointBaseUri</span><span class="s2">/referencing-requests/partner/</span><span class="nv">$partnerId</span><span class="s2">/permission"</span><span class="p">,</span>
  <span class="p">[</span>
    <span class="s2">"headers"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"Authorization"</span> <span class="o">=&gt;</span> <span class="nv">$authorizationToken</span><span class="p">,</span>
      <span class="s2">"x-api-key"</span> <span class="o">=&gt;</span> <span class="nv">$apiKey</span>
    <span class="p">],</span>
    <span class="s2">"json"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"example@gmail.com"</span><span class="p">,</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getBody</span><span class="p">(),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"request_id"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"renterId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UUID"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"permissionRequestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"UUID"</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>With using this request your company can request share permission for specific user.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>POST /referencing-requests/partner/:partnerId/permission</code></p>
<h3 id='url-parameters-2'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>partnerId</td>
<td>Your partner reference</td>
</tr>
</tbody></table>
<h3 id='body-parameters-3'>Body Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>true</td>
<td>renter email to which we will send “share permission” request</td>
</tr>
</tbody></table>
<h1 id='create-connection'>Create connection</h1><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">canopyEndpointBaseUri</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">canopy_base_uri</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">apiKey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">your_api_key</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">authorizationToken</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">authorization_token</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">partnerId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">partner_id</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">axios</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">canopyEndpointBaseUri</span><span class="p">}</span><span class="s2">/referencing-requests/partner/</span><span class="p">${</span><span class="nx">partnerId</span><span class="p">}</span><span class="s2">/branch-connection`</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="nx">authorizationToken</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">x-api-key</span><span class="dl">"</span><span class="p">:</span> <span class="nx">apiKey</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="nl">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">branchId</span><span class="p">:</span> <span class="dl">"</span><span class="s2">UUID</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">email</span><span class="p">:</span> <span class="dl">"</span><span class="s2">string</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">listingName</span><span class="p">:</span> <span class="dl">"</span><span class="s2">String</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">listingUrl</span><span class="p">:</span> <span class="dl">"</span><span class="s2">URL String</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">propertyAddress</span><span class="p">:</span> <span class="dl">"</span><span class="s2">String</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">inquiryType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">String</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">inquiryTimestamp</span><span class="p">:</span> <span class="dl">"</span><span class="s2">timestamp</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">renterMessage</span><span class="p">:</span> <span class="dl">"</span><span class="s2">String</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="nv">$canopyEndpointBaseUri</span> <span class="o">=</span> <span class="s2">"canopy_base_uri"</span><span class="p">;</span>
<span class="nv">$apiKey</span> <span class="o">=</span> <span class="s2">"your_api_key"</span><span class="p">;</span>
<span class="nv">$authorizationToken</span> <span class="o">=</span> <span class="s2">"authorization_token"</span><span class="p">;</span>
<span class="nv">$partnerId</span> <span class="o">=</span> <span class="s2">"your_partner_id"</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="err">\</span><span class="nf">GuzzleHttp\Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">request</span><span class="p">(</span>
  <span class="s2">"POST"</span><span class="p">,</span>
  <span class="s2">"</span><span class="nv">$canopyEndpointBaseUri</span><span class="s2">/referencing-requests/partner/</span><span class="nv">$partnerId</span><span class="s2">/branch-connection"</span><span class="p">,</span>
  <span class="p">[</span>
    <span class="s2">"headers"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"Authorization"</span> <span class="o">=&gt;</span> <span class="nv">$authorizationToken</span><span class="p">,</span>
      <span class="s2">"x-api-key"</span> <span class="o">=&gt;</span> <span class="nv">$apiKey</span>
    <span class="p">],</span>
    <span class="s2">"json"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"branchId"</span> <span class="o">=&gt;</span> <span class="s2">"UUID"</span><span class="p">,</span>
      <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"String"</span><span class="p">,</span>
      <span class="s2">"listingName"</span> <span class="o">=&gt;</span> <span class="s2">"String"</span><span class="p">,</span>
      <span class="s2">"listingUrl"</span> <span class="o">=&gt;</span> <span class="s2">"String"</span><span class="p">,</span>
      <span class="s2">"propertyAddress"</span> <span class="o">=&gt;</span> <span class="s2">"String"</span><span class="p">,</span>
      <span class="s2">"renterMessage"</span> <span class="o">=&gt;</span> <span class="s2">"String"</span><span class="p">,</span>
      <span class="s2">"inquiryType"</span> <span class="o">=&gt;</span> <span class="s2">"String"</span><span class="p">,</span>
      <span class="s2">"inquiryTimestamp"</span> <span class="o">=&gt;</span> <span class="s2">"timestamp"</span><span class="p">,</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getBody</span><span class="p">(),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"requestId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"request_id"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"HQlink"</span><span class="p">:</span><span class="w"> </span><span class="s2">"URL"</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint creates new connection between renter and agent by branchId.</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>POST /referencing-requests/partner/:partnerId/branch-connection</code></p>
<h3 id='url-parameters-3'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>partnerId</td>
<td>Your partner reference</td>
</tr>
</tbody></table>
<h3 id='body-parameters-4'>Body Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>branchId</td>
<td>string</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>email</td>
<td>string</td>
<td>true</td>
<td>renter email to which we will send “share permission” request</td>
</tr>
<tr>
<td>listingName</td>
<td>string</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>listingUrl</td>
<td>string</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>propertyAddress</td>
<td>string</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>inquiryType</td>
<td>string</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>inquiryTimestamp</td>
<td>string</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>renterMessage</td>
<td>string</td>
<td>false</td>
<td></td>
</tr>
</tbody></table>
<h1 id='webhooks-endpoints'>Webhooks Endpoints</h1><h2 id='register-webhook'>Register Webhook</h2><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">canopyEndpointBaseUri</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">canopy_base_uri</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">partnerId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">partner_id</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">axios</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">canopyEndpointBaseUri</span><span class="p">}</span><span class="s2">/referencing-requests/partner/</span><span class="p">${</span><span class="nx">partnerId</span><span class="p">}</span><span class="s2">/webhook/register`</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">authorization_token</span><span class="dl">"</span>
    <span class="dl">"</span><span class="s2">x-api-key</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">api_key</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">"</span><span class="s2">OVERALL_STATUS_UPDATES</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">callbackUrl</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://callbackurl.com</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="nv">$canopyEndpointBaseUri</span> <span class="o">=</span> <span class="s2">"canopy_base_uri"</span><span class="p">;</span>
<span class="nv">$apiKey</span> <span class="o">=</span> <span class="s2">"your_api_key"</span><span class="p">;</span>
<span class="nv">$authorizationToken</span> <span class="o">=</span> <span class="s2">"authorization_token"</span><span class="p">;</span>
<span class="nv">$partnerId</span> <span class="o">=</span> <span class="s2">"your_partner_id"</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="err">\</span><span class="nf">GuzzleHttp\Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">request</span><span class="p">(</span>
  <span class="s2">"POST"</span><span class="p">,</span>
  <span class="s2">"</span><span class="nv">$canopyEndpointBaseUri</span><span class="s2">/referencing-requests/partner/</span><span class="nv">$partnerId</span><span class="s2">/webhook/register"</span><span class="p">,</span>
  <span class="p">[</span>
    <span class="s2">"headers"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"Authorization"</span> <span class="o">=&gt;</span> <span class="nv">$authorizationToken</span><span class="p">,</span>
      <span class="s2">"x-api-key"</span> <span class="o">=&gt;</span> <span class="nv">$apiKey</span>
    <span class="p">],</span>
    <span class="s2">"json"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"type"</span> <span class="o">=&gt;</span> <span class="s2">"OVERALL_STATUS_UPDATES"</span><span class="p">,</span>
      <span class="s2">"callbackUrl"</span> <span class="o">=&gt;</span> <span class="s2">"https://callbackurl.com"</span><span class="p">,</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getBody</span><span class="p">(),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"webhookType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OVERALL_STATUS_UPDATES"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"callbackUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://callbackurl.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint registers the webhook with the appropriate type in Canopy system. After that, Rent Passport updates will be sent to the specified callback url.</p>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>POST /referencing-requests/partner/:partnerId/webhook/register</code></p>
<h3 id='url-parameters-4'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>partnerId</td>
<td>Your partner reference</td>
</tr>
</tbody></table>
<h3 id='body-parameters-5'>Body Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>string</td>
<td>true</td>
<td>Specifies which type of updates will be sent from Canopy. Could be one of [&quot;OVERALL_STATUS_UPDATES&quot;, &quot;PERMISSION_REQUEST_UPDATES&quot;]</td>
</tr>
<tr>
<td>callbackUrl</td>
<td>string</td>
<td>true</td>
<td>The URL of the webhook endpoint</td>
</tr>
</tbody></table>
<h3 id='event-types'>Event types</h3>
<p>If you subscribed to the <code>PERMISSION_REQUEST_UPDATES</code> type, the updates will be sent to the <code>callbackUrl</code> each time one of the following events trigger:</p>

<table><thead>
<tr>
<th>Event</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>PERMISSION_USER_INVITED</code></td>
<td>The user was invited to join Canopy</td>
</tr>
<tr>
<td><code>PERMISSION_INVITE_RESENT</code></td>
<td>Invitation email was resent to the user</td>
</tr>
<tr>
<td><code>PERMISSION_APPROVED</code></td>
<td>User accepts the permission request</td>
</tr>
<tr>
<td><code>PERMISSION_DENIED</code></td>
<td>User denied the permission request</td>
</tr>
<tr>
<td><code>PERMISSION_STOPPED</code></td>
<td>User stopped share permission with your company</td>
</tr>
</tbody></table>

<p>Once <code>PERMISSION_REQUEST_UPDATES</code> event trigger, the Canopy should sent the notification to <code>callbackUrl</code> in the following format:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>canopyRenterId</td>
<td>UUID</td>
</tr>
<tr>
<td>permissionRequestId</td>
<td>UUID</td>
</tr>
<tr>
<td>partnerId</td>
<td>UUID</td>
</tr>
<tr>
<td>notes</td>
<td>string</td>
</tr>
</tbody></table>

<p>If you are subscribed to the <code>OVERALL_STATUS_UPDATES</code> type, the updates will be sent to the <code>callbackUrl</code> when one of the following Rent Passport will be complete</p>
<h3 id='notification-format'>Notification format</h3>
<p>Once <code>OVERALL_STATUS_UPDATES</code> event trigger, the Canopy should sent the notification to <code>callbackUrl</code> in the following format:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>canopyRenterId</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>partnerId</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td>overallStatus</td>
<td>string</td>
<td>One of [&quot;NOT_STARTED&quot;, &quot;IN_PROGRESS&quot;, &quot;ACCEPT&quot;, &quot;CONSIDER&quot;, &quot;HIGH_RISK&quot;]</td>
</tr>
</tbody></table>
<h2 id='unregister-webhook'>Unregister Webhook</h2><div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">const</span> <span class="nx">axios</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">axios</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">canopyEndpointBaseUri</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">canopy_base_uri</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">partnerId</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">partner_id</span><span class="dl">"</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">webhookType</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">OVERALL_STATUS_UPDATES</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">axios</span><span class="p">({</span>
  <span class="na">url</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">canopyEndpointBaseUri</span><span class="p">}</span><span class="s2">/referencing-requests/partner/</span><span class="p">${</span><span class="nx">partnerId</span><span class="p">}</span><span class="s2">/webhook/</span><span class="p">${</span><span class="nx">webhookType</span><span class="p">}</span><span class="s2">`</span><span class="p">,</span>
  <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">DELETE</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">authorization_token</span><span class="dl">"</span>
    <span class="dl">"</span><span class="s2">x-api-key</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">api_key</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="nv">$canopyEndpointBaseUri</span> <span class="o">=</span> <span class="s2">"canopy_base_uri"</span><span class="p">;</span>
<span class="nv">$apiKey</span> <span class="o">=</span> <span class="s2">"your_api_key"</span><span class="p">;</span>
<span class="nv">$authorizationToken</span> <span class="o">=</span> <span class="s2">"authorization_token"</span><span class="p">;</span>
<span class="nv">$clientId</span> <span class="o">=</span> <span class="s2">"your_client_id"</span><span class="p">;</span>

<span class="nv">$client</span> <span class="o">=</span> <span class="k">new</span> <span class="err">\</span><span class="nf">GuzzleHttp\Client</span><span class="p">();</span>
<span class="nv">$response</span> <span class="o">=</span> <span class="nv">$client</span><span class="o">-&gt;</span><span class="nf">request</span><span class="p">(</span>
  <span class="s2">"DELETE"</span><span class="p">,</span>
  <span class="s2">"</span><span class="nv">$canopyEndpointBaseUri</span><span class="s2">/referencing-requests/partner/</span><span class="nv">$partnerId</span><span class="s2">/webhook/</span><span class="nv">$webhookType</span><span class="s2">"</span><span class="p">,</span>
  <span class="p">[</span>
    <span class="s2">"headers"</span> <span class="o">=&gt;</span> <span class="p">[</span>
      <span class="s2">"Authorization"</span> <span class="o">=&gt;</span> <span class="nv">$authorizationToken</span><span class="p">,</span>
      <span class="s2">"x-api-key"</span> <span class="o">=&gt;</span> <span class="nv">$apiKey</span>
    <span class="p">]</span>
  <span class="p">]</span>
<span class="p">);</span>

<span class="k">echo</span> <span class="nv">$response</span><span class="o">-&gt;</span><span class="nf">getBody</span><span class="p">(),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"webhookType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OVERALL_STATUS_UPDATES"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint unregisters webhook and stops sending Rent Passport updates to the specified callback URL.</p>
<h3 id='http-request-7'>HTTP Request</h3>
<p><code>DELETE /referencing-requests/partner/:partnerId/webhook/:webhookType</code></p>
<h3 id='url-parameters-5'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>partnerId</td>
<td>Your partner reference</td>
</tr>
<tr>
<td>webhookType</td>
<td>The type of the webhook you want to unregister</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1>
<p>We use conventional HTTP response codes to indicate the success or failure of an API request, typically one of:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>2xx</td>
<td>Indicates success</td>
</tr>
<tr>
<td>4xx</td>
<td>Indicates a client error with information provided (missign required parameters etc..)</td>
</tr>
<tr>
<td>5xx</td>
<td>Indicates an error with the Canopy platform</td>
</tr>
</tbody></table>

<p>We suggest you wrap 4xx errors in your client and provide a user friendly message to your end users as part of the integration.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
